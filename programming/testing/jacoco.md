## Jacoco
- **Configuration:** Define jacoco plugin in maven pom with two phases: prepare and report.
  - Jacoco will generate jacoco-unit.exec after first phase.  
  - View jacoco report in target site folder
    Report is executed in report phase, which create report under /target/site.  
- **Error:** "Skipping Jacoco execution due to missing execution data file" upon executing Jacoco.  
  Reason: No test case is created. src/test/java is empty.
- **Exclusion in report**  
  Exclusion ONLY be performed in report generation. Jacoco will always instruct the code in runtime.  
  - **Lombok Exclusion**  
    To exclude all Lombok-generated bytecode by adding a property to lombok.config file.  
    lombok.addLombokGeneratedAnnotation = true  
    https://projectlombok.org/features/configuration  
    This will add @lombok.Generated annotations to all generated nodes where possible.  
    Note: JaCoCo performs analysis of bytecode and hence annotation must have retention policy RUNTIME (aka "runtime visible") or CLASS (aka "runtime invisible" yet retained in class files)  
    javax.annotation.Generated or javax.annotation.processing.Generated unfortunately both have retention policy SOURCE (aka discarded by compiler).
  - **Jacoco Plugin Report Exclusion**  
    - Use pom.xml  
      Define exclusion in maven plugin configuration.  
    - Use @Generated annotation  
      Classes and methods annotated with annotation whose retention policy is runtime or class and whose simple name is Generated are filtered out during generation of report (For jacoco plugin, and NOT applicable to sonar)  
      ```java
      // need to test whether name like ExcludeFromJacocoGeneratedReport is working or not???
      @java.lang.annotation.Retention(java.lang.annotation.RetentionPolicy.RUNTIME)
      @interface Generated {}
      ```
  - **SonarType Report Exclusion**  
    The exclustion of classes is ONLY happening at report phase, the plugin or sonarType is generating report from jacoco result jacoco-unit.exec.
    Thus, jacoco plugin exclusion is only for the jacoco report generated under folder /site/jacoco.  
    For Sonar report (CICD), need to set:  
    ```init
    sonar.exclusion=....
    ```
- Can use beantutils.copyProperties to make sure code are covered in Jacoco.

